% lualatex tenuki30
\nonstopmode


\documentclass[11pt,a4paper]{ltjsarticle}
\usepackage{listings}
\usepackage{graphicx}
\usepackage{here}
\title{手抜きについて}
\author{手抜きチーム}
\date{2020年2月9日}


\begin{document}

\maketitle

手抜きはCSAプロトコルで対局を行うコンピュータ将棋プログラムです。作者らが将棋のプログラムの仕組みを理解することを目的として開発しています。
リポジトリ：https://github.com/hikaen2/tenuki-d



\section{作者について}

\subsubsection*{鈴木太朗}
鈴木はプログラマです。
自転車とEmacsが好きです。
小学校のとき将棋部でしたが，将棋は強くありません（推定30級）。
Twitter: @hikaen2

\subsubsection*{玉川直樹}
玉川はP兼召喚士です。KPPとレーティングシステムを疑っています。将棋ウォーズ2段。
手抜きの定跡を手入力で作りました。
Twitter: @Neakih\_kick



\section{おまけ}

\subsection{D言語について}

\subsection{CSAプロトコルについて}
手抜きはCSAプロトコル (http://www2.computer-shogi.org/protocol/) で対局します。
ほかに有名なプロトコルとしてUSI (Universal Shogi Interface) プロトコルがあります (http://shogidokoro.starfree.jp/usi.html)。
WCSCの場合，対戦サーバがCSAプロトコルですから，USIプロトコルでは対局できません。

CSAプロトコルの注意点

・本番用サーバで指し手のパケットを分割すると受理されない
WCSC28のときに，CSAプロトコルで指し手を複数パケットに分けて送信したところ，受理されませんでした。
shogi-server (http://shogi-server.osdn.jp/) ではこの現象が起きません。

・指し手がエラーでないことが分からない

エラーがある手を指すと，サーバは\verb|#ILLEGAL_MOVE|というレスポンスを返します：
\begin{verbatim*}
+0032FU,T1
#ILLEGAL_MOVE
#LOSE
\end{verbatim}

この場合，エラーがあることが分かります。

一方，エラーがない手を指すと，サーバはエラーがなかったことを示すレスポンスを返しません：
\begin{verbatim*}
+0032FU,T1
\end{verbatim}

この場合，エラーがなかったことが分かりません。

期待する挙動：
エラーがあればエラーがあったことを示すレスポンスが返り，エラーがなければエラーがなかったことを示すレスポンスが返る。





\section{目標}

\subsection{今年の目標}

\begin{itemize}
  \item リモート参加
  \item GUI
  \item 時間管理
  \item undoMove
  \item 駒背番号制にする
  \item 置換表をStockfishっぽくする
  \item movePickerを作る
  \item aspiration searchする
  \item 差分評価する
  \item futility pruningする
  \item ponder
  \item df-pnする
\end{itemize}


\begin{itemize}
  \item リモート参加
\end{itemize}

指し手の生成を選手権の会場外にあるリモートマシンで実行することをリモート参加といいます
（世界コンピュータ将棋選手権 大会ルール 第３章　第１２条）。
リモートマシンとはインターネットで接続するのですが，おそらく間にNAT (NAPT) があります（明言されていない）。
そして対戦用サーバはインターネットに接続されていません。


\begin{itemize}
  \item 探索をマルチスレッドにする
\end{itemize}

Ryzenを買っちゃったのでマルチスレッドにします。
これからLazy SMPを実装します。
スレッドがよくわかりません。
実装できても正しく実装できているか分からない予感がします。

\begin{itemize}
  \item KPPTで評価する
\end{itemize}

去年はなのはさんの評価バイナリでKP + PPで評価しました。
今年はAperyの評価バイナリ（大樹の枝形式）でKPPTで評価しようと思います。
Aperyの選定理由は評価バイナリがKPPTだからです。
予想として，静的評価に手番が含まれると静止探索がいらないか，もしくは軽くていいのではないかと思っています。

評価バイナリの自作については来年挑戦します。


\subsection{来年の目標}

\begin{itemize}
  \item 評価バイナリを自作する
\end{itemize}


\subsection{去年までの目標と結果}

第28回世界コンピュータ将棋選手権：
\begin{itemize}
  \item ルール通りに指す → 結果：ルール通り指した（けど千日手のチェックをしてない）
  \item 投了する（第27回では王手放置していた） → 結果：投了した。一次予選4勝4敗
  \item KPで評価する → 結果：なのはさんの評価バイナリでKP + PPで評価した
\end{itemize}

第27回世界コンピュータ将棋選手権：
\begin{itemize}
  \item 出場する → 結果：出場した
  \item 対局する → 結果：対局した。一次予選2勝5敗
\end{itemize}



\end{document}
